# å¼€å‘æŒ‡å—

## ğŸ”§ å¼€å‘ç¯å¢ƒé…ç½®

### åç«¯é…ç½®

ç¼–è¾‘ `backend/src/main/resources/application.yml`ï¼š

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/fire_management
    username: root
    password: your_password  # ä¿®æ”¹ä¸ºä½ çš„å¯†ç 
  
  redis:
    host: localhost
    port: 6379

file:
  upload-path: D:/uploads/  # æ–‡ä»¶ä¸Šä¼ è·¯å¾„
  access-url: http://localhost:8080/files/
```

### å‰ç«¯é…ç½®

API åœ°å€é…ç½®åœ¨ `web-admin/src/utils/request.js`ï¼š

```javascript
const baseURL = 'http://localhost:8080/api'
```

### åœ°å›¾é…ç½®ï¼ˆé‡è¦ï¼‰

1. è®¿é—® https://lbs.amap.com/ è·å–é«˜å¾·åœ°å›¾ API Key
2. ç¼–è¾‘ `web-admin/src/views/Map.vue`ï¼Œæ›¿æ¢ API Key
3. è¯¦è§ `web-admin/MAP_SETUP.md`

## ğŸ§ª æµ‹è¯•

### æ·»åŠ æµ‹è¯•æ•°æ®

```bash
# æ–¹æ³•1ï¼šæ‰§è¡Œå®Œæ•´åˆå§‹åŒ–ï¼ˆæ¨èï¼‰
mysql -u root -p --default-character-set=utf8mb4 < backend/INIT_ALL.sql

# æ–¹æ³•2ï¼šåªæ·»åŠ æµ‹è¯•æ•°æ®
mysql -u root -p --default-character-set=utf8mb4 < backend/INSERT_TEST_DATA.sql
```

### API æµ‹è¯•

```bash
# ç™»å½•
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"123456","clientType":"web"}'

# æŸ¥è¯¢è®¾æ–½åˆ—è¡¨
curl -X GET "http://localhost:8080/api/facilities?pageNum=1&pageSize=10" \
  -H "Authorization: Bearer YOUR_TOKEN"

# æŸ¥è¯¢å‘¨è¾¹è®¾æ–½
curl -X GET "http://localhost:8080/api/facilities/nearby?latitude=22.5174&longitude=113.3926&radius=500" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. 403 æƒé™é”™è¯¯

**ç°è±¡ï¼š** é¡µé¢æ˜¾ç¤º "Request failed with status code 403"

**åŸå› ï¼š** æƒé™é…ç½®ä¸¢å¤±æˆ– Token è¿‡æœŸ

**è§£å†³ï¼š**

```bash
# 1. ä¿®å¤æƒé™
mysql -u root -p -e "USE fire_management; UPDATE sys_role SET permissions = 'user:manage,facility:manage,facility:view,audit:manage,stats:view,system:config' WHERE role_id = 1;"

# 2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¹¶é‡æ–°ç™»å½•
# - æŒ‰ F12 â†’ Application â†’ Local Storage
# - åˆ é™¤ token å’Œ userInfo
# - åˆ·æ–°é¡µé¢ï¼Œé‡æ–°ç™»å½•
```

### 2. é¡µé¢æ˜¾ç¤º"æš‚æ— æ•°æ®"

**åŸå› ï¼š** æ•°æ®åº“ä¸­æ²¡æœ‰æ•°æ®

**è§£å†³ï¼š**

```bash
# æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
mysql -u root -p --default-character-set=utf8mb4 < backend/INIT_ALL.sql

# éªŒè¯æ•°æ®
mysql -u root -p -e "USE fire_management; SELECT COUNT(*) FROM fire_facility WHERE deleted = 0;"
```

### 3. æ•°æ®åº“è¿æ¥å¤±è´¥

**æ£€æŸ¥é¡¹ï¼š**
- MySQL æœåŠ¡æ˜¯å¦å¯åŠ¨
- æ•°æ®åº“åç§°æ˜¯å¦æ­£ç¡®ï¼ˆfire_managementï¼‰
- ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
- ç«¯å£æ˜¯å¦ä¸º 3306

### 4. å‰ç«¯å¯åŠ¨å¤±è´¥

```bash
# åˆ é™¤ä¾èµ–é‡æ–°å®‰è£…
rm -rf node_modules package-lock.json
npm install

# å¦‚æœç«¯å£è¢«å ç”¨ï¼Œä¿®æ”¹ vite.config.js
server: {
  port: 3001  # æ”¹ä¸ºå…¶ä»–ç«¯å£
}
```

### 5. è·¨åŸŸé—®é¢˜

åç«¯å·²é…ç½® CORSï¼Œå¦‚æœä»æœ‰é—®é¢˜ï¼Œæ£€æŸ¥ï¼š
- åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
- å‰ç«¯ API åœ°å€æ˜¯å¦æ­£ç¡®
- æµè§ˆå™¨æ˜¯å¦ç¦ç”¨äº†è·¨åŸŸè¯·æ±‚

## ğŸ“Š æ•°æ®åº“è¯´æ˜

### æ ¸å¿ƒè¡¨

| è¡¨å | è¯´æ˜ |
|------|------|
| sys_user | ç”¨æˆ·è¡¨ |
| sys_role | è§’è‰²è¡¨ |
| fire_facility | æ¶ˆé˜²è®¾æ–½è¡¨ |
| facility_photo | è®¾æ–½ç…§ç‰‡è¡¨ |
| audit_record | å®¡æ ¸è®°å½•è¡¨ |
| operation_log | æ“ä½œæ—¥å¿—è¡¨ |

### æƒé™è¯´æ˜

| è§’è‰² | æƒé™ä»£ç  |
|------|----------|
| ç³»ç»Ÿç®¡ç†å‘˜ | user:manage, facility:manage, facility:view, audit:manage, stats:view, system:config |
| æ•°æ®é‡‡é›†å‘˜ | facility:collect, facility:view |
| æ¶ˆé˜²æˆ˜å£« | facility:view, facility:navigate |
| æ•°æ®å®¡æ ¸å‘˜ | audit:manage, facility:view |

## ğŸ” è°ƒè¯•æŠ€å·§

### åç«¯è°ƒè¯•

1. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
2. ä½¿ç”¨ IDE æ–­ç‚¹è°ƒè¯•
3. æ£€æŸ¥ SQL æ‰§è¡Œæƒ…å†µ

### å‰ç«¯è°ƒè¯•

1. **æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰**
   - Consoleï¼šæŸ¥çœ‹é”™è¯¯æ—¥å¿—
   - Networkï¼šæŸ¥çœ‹ API è¯·æ±‚å“åº”
   - Applicationï¼šæŸ¥çœ‹ LocalStorage

2. **Vue DevTools**
   - å®‰è£… Vue DevTools æµè§ˆå™¨æ’ä»¶
   - æŸ¥çœ‹ç»„ä»¶çŠ¶æ€å’Œæ•°æ®æµ

### å¸¸ç”¨è°ƒè¯•å‘½ä»¤

```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
tail -f backend/logs/app.log

# æŸ¥çœ‹ MySQL æ…¢æŸ¥è¯¢
mysql -u root -p -e "SHOW FULL PROCESSLIST;"

# æµ‹è¯• API è¿é€šæ€§
curl http://localhost:8080/api/health
```

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ

- åç«¯éµå¾ª RESTful API è®¾è®¡
- å‰ç«¯ä½¿ç”¨ Vue 3 Composition API
- å˜é‡å‘½åï¼šé©¼å³°å‘½åæ³•
- æ³¨é‡Šï¼šå…³é”®é€»è¾‘å¿…é¡»æ³¨é‡Š

### Git æäº¤è§„èŒƒ

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·ç›¸å…³
```

### API æ¥å£è§„èŒƒ

**è¯·æ±‚æ ¼å¼ï¼š**
```json
{
  "pageNum": 1,
  "pageSize": 10,
  "keyword": "æœç´¢å…³é”®è¯"
}
```

**å“åº”æ ¼å¼ï¼š**
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [],
    "total": 100
  }
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### åç«¯ä¼˜åŒ–

1. ä½¿ç”¨ Redis ç¼“å­˜çƒ­ç‚¹æ•°æ®
2. æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
3. åˆ†é¡µæŸ¥è¯¢é¿å…å…¨è¡¨æ‰«æ
4. ä½¿ç”¨è¿æ¥æ± ç®¡ç†æ•°æ®åº“è¿æ¥

### å‰ç«¯ä¼˜åŒ–

1. è·¯ç”±æ‡’åŠ è½½
2. å›¾ç‰‡æ‡’åŠ è½½
3. ç»„ä»¶æŒ‰éœ€å¼•å…¥
4. ä½¿ç”¨ CDN åŠ é€Ÿé™æ€èµ„æº

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `backend/DATABASE.md` - æ•°æ®åº“è¯¦ç»†æ–‡æ¡£
- `backend/SECURITY.md` - å®‰å…¨é…ç½®è¯´æ˜
- `backend/PERFORMANCE.md` - æ€§èƒ½ä¼˜åŒ–å»ºè®®
- `web-admin/MAP_SETUP.md` - åœ°å›¾é…ç½®æŒ‡å—
- `éƒ¨ç½²æŒ‡å—.md` - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

## ğŸ’¡ å¼€å‘å»ºè®®

1. **ä½¿ç”¨ IDE**
   - åç«¯ï¼šIntelliJ IDEA
   - å‰ç«¯ï¼šVS Code + Volar æ’ä»¶

2. **ç‰ˆæœ¬æ§åˆ¶**
   - åŠæ—¶æäº¤ä»£ç 
   - å†™æ¸…æ¥šæäº¤ä¿¡æ¯
   - å®šæœŸæ¨é€åˆ°è¿œç¨‹ä»“åº“

3. **æµ‹è¯•é©±åŠ¨**
   - å…ˆå†™æµ‹è¯•ç”¨ä¾‹
   - å†å®ç°åŠŸèƒ½
   - ç¡®ä¿æµ‹è¯•é€šè¿‡

4. **æ–‡æ¡£åŒæ­¥**
   - ä»£ç å˜æ›´æ—¶æ›´æ–°æ–‡æ¡£
   - API å˜æ›´æ—¶æ›´æ–°æ¥å£æ–‡æ¡£
   - é‡è¦å†³ç­–è®°å½•åœ¨æ–‡æ¡£ä¸­
