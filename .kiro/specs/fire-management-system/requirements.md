# 需求文档

## 引言

本系统是一个消防设施管理系统，旨在解决消防救援支队在消防栓等基础数据底数不清、状态更新滞后、现场查询手段缺乏等问题。系统采用"云-管-端"混合架构，支持数据采集、设备查询、数据审核和统计分析等核心功能。

## 术语表

- **消防设施系统（Fire Management System）**：本文档所描述的消防设施管理软件系统
- **消防栓（Fire Hydrant）**：城市消防供水设施
- **数据采集员（Data Collector）**：负责现场采集消防设施信息的人员
- **消防战士（Firefighter）**：使用系统查询消防设施位置的消防人员
- **系统管理员（System Administrator）**：负责系统管理、数据审核的管理人员
- **GPS定位（GPS Positioning）**：全球定位系统，用于获取设备位置
- **离线模式（Offline Mode）**：无网络连接时的系统工作模式
- **数据同步（Data Synchronization）**：客户端与服务端之间的数据传输过程

## 需求

### 需求 1：用户认证与权限管理

**用户故事：** 作为系统管理员，我希望能够管理用户账号和权限，以便控制不同角色对系统功能的访问。

#### 验收标准

1. WHEN 用户输入正确的账号和密码 THEN 消防设施系统 SHALL 验证用户身份并返回访问令牌
2. WHEN 用户输入错误的账号或密码 THEN 消防设施系统 SHALL 拒绝登录并提示错误信息
3. WHEN 用户令牌过期 THEN 消防设施系统 SHALL 要求用户重新登录
4. WHEN 系统管理员创建新用户 THEN 消防设施系统 SHALL 分配角色并设置初始密码
5. WHEN 用户尝试访问无权限的功能 THEN 消防设施系统 SHALL 拒绝访问并返回权限不足提示

### 需求 2：消防设施数据采集

**用户故事：** 作为数据采集员，我希望能够在移动端快速采集消防设施信息，以便建立完整的消防设施数据库。

#### 验收标准

1. WHEN 数据采集员拍摄消防栓照片 THEN 消防设施系统 SHALL 自动获取GPS位置并关联到照片
2. WHEN 数据采集员填写设施信息 THEN 消防设施系统 SHALL 验证必填字段的完整性
3. WHEN 数据采集员在离线状态下采集数据 THEN 消防设施系统 SHALL 将数据保存到本地数据库
4. WHEN 设备恢复网络连接 THEN 消防设施系统 SHALL 自动同步本地数据到服务器
5. WHEN 数据采集员提交采集数据 THEN 消防设施系统 SHALL 将数据标记为待审核状态

### 需求 3：消防设施查询

**用户故事：** 作为消防战士，我希望能够快速查询周边消防设施位置和状态，以便在紧急情况下快速找到可用设施。

#### 验收标准

1. WHEN 消防战士打开地图页面 THEN 消防设施系统 SHALL 在2秒内显示当前位置周边1公里内的消防设施
2. WHEN 消防战士点击设施图标 THEN 消防设施系统 SHALL 显示设施详细信息包括地址、压力、状态和照片
3. WHEN 消防战士搜索特定位置 THEN 消防设施系统 SHALL 显示该位置周边指定半径内的消防设施
4. WHEN 消防战士在离线模式下查询 THEN 消防设施系统 SHALL 使用本地缓存数据提供查询结果
5. WHEN 消防战士选择导航功能 THEN 消防设施系统 SHALL 规划从当前位置到目标设施的步行路线

### 需求 4：数据审核与管理

**用户故事：** 作为系统管理员，我希望能够审核采集的数据，以便确保数据库中的信息准确可靠。

#### 验收标准

1. WHEN 系统管理员查看待审核列表 THEN 消防设施系统 SHALL 显示所有待审核的设施数据
2. WHEN 系统管理员审核通过数据 THEN 消防设施系统 SHALL 将数据状态更新为已通过并同步到公共数据库
3. WHEN 系统管理员驳回数据 THEN 消防设施系统 SHALL 要求填写驳回原因并通知采集员
4. WHEN 系统管理员修改设施信息 THEN 消防设施系统 SHALL 记录修改历史和操作人
5. WHEN 系统管理员删除设施数据 THEN 消防设施系统 SHALL 执行软删除并保留删除记录

### 需求 5：数据去重处理

**用户故事：** 作为系统管理员，我希望系统能够自动识别和处理重复的消防设施数据，以便保持数据库的准确性。

#### 验收标准

1. WHEN 新采集的消防栓位置与已有数据距离小于10米 THEN 消防设施系统 SHALL 判定为重复数据
2. WHEN 系统检测到重复数据 THEN 消防设施系统 SHALL 保留置信度最高或信息最完整的记录
3. WHEN 系统合并重复数据 THEN 消防设施系统 SHALL 将其他记录标记为已合并状态
4. WHEN 系统执行去重算法 THEN 消防设施系统 SHALL 使用空间索引优化查询性能
5. WHEN 去重处理完成 THEN 消防设施系统 SHALL 记录合并操作的详细信息

### 需求 6：统计分析与看板

**用户故事：** 作为系统管理员，我希望能够查看消防设施的统计数据和分布情况，以便进行宏观管理和决策。

#### 验收标准

1. WHEN 系统管理员访问看板页面 THEN 消防设施系统 SHALL 显示设施总数、区域分布、状态比例等关键指标
2. WHEN 系统管理员查看热力图 THEN 消防设施系统 SHALL 按区域显示设施密度分布
3. WHEN 系统管理员选择时间范围 THEN 消防设施系统 SHALL 显示该时间段内的采集趋势
4. WHEN 系统管理员导出统计数据 THEN 消防设施系统 SHALL 生成Excel格式的报表文件
5. WHEN 看板数据更新 THEN 消防设施系统 SHALL 在5分钟内反映最新的数据变化

### 需求 7：离线数据同步

**用户故事：** 作为数据采集员，我希望在网络不稳定的环境下也能正常工作，以便在各种现场条件下完成数据采集。

#### 验收标准

1. WHEN 移动端检测到网络断开 THEN 消防设施系统 SHALL 自动切换到离线模式
2. WHEN 移动端在离线模式下操作 THEN 消防设施系统 SHALL 将所有操作记录保存到本地数据库
3. WHEN 网络恢复连接 THEN 消防设施系统 SHALL 自动触发数据同步流程
4. WHEN 执行数据同步 THEN 消防设施系统 SHALL 仅上传新增或变更的数据
5. WHEN 同步过程中断 THEN 消防设施系统 SHALL 支持断点续传功能

### 需求 8：地图可视化

**用户故事：** 作为消防战士，我希望在地图上直观地看到消防设施的位置和状态，以便快速了解周边情况。

#### 验收标准

1. WHEN 用户打开地图页面 THEN 消防设施系统 SHALL 加载底图并显示设施标注
2. WHEN 用户缩放或平移地图 THEN 消防设施系统 SHALL 在1秒内响应并更新显示内容
3. WHEN 系统显示设施图标 THEN 消防设施系统 SHALL 根据设施状态使用不同颜色标识
4. WHEN 用户点击设施图标 THEN 消防设施系统 SHALL 弹出信息窗口显示基本信息
5. WHEN 用户在户外强光环境下使用 THEN 消防设施系统 SHALL 提供高对比度显示模式

### 需求 9：文件存储与管理

**用户故事：** 作为数据采集员，我希望能够上传和查看消防设施的照片，以便记录设施的实际状态。

#### 验收标准

1. WHEN 数据采集员上传照片 THEN 消防设施系统 SHALL 自动压缩照片到1080P分辨率
2. WHEN 照片上传到服务器 THEN 消防设施系统 SHALL 将文件存储到对象存储服务
3. WHEN 用户查看设施详情 THEN 消防设施系统 SHALL 加载并显示关联的照片
4. WHEN 照片上传失败 THEN 消防设施系统 SHALL 支持重试机制
5. WHEN 用户删除设施数据 THEN 消防设施系统 SHALL 同时删除关联的照片文件

### 需求 10：智能距离查询与导航

**用户故事：** 作为消防战士，我希望能够使用智能化的距离查询功能，以便快速找到最近的消防设施并获得精确的导航指引。

#### 验收标准

1. WHEN 用户在地图上设置查询半径 THEN 消防设施系统 SHALL 显示可视化的距离圈并实时更新范围内的设施
2. WHEN 用户选择距离单位 THEN 消防设施系统 SHALL 支持米和公里两种单位的切换显示
3. WHEN 用户查看设施列表 THEN 消防设施系统 SHALL 实时显示每个设施到当前位置的精确距离
4. WHEN 用户使用距离筛选器 THEN 消防设施系统 SHALL 支持按距离范围（100米内、500米内、1公里内、自定义）筛选设施
5. WHEN 用户选择设施进行导航 THEN 消防设施系统 SHALL 提供步行、驾车、骑行三种路径规划方案
6. WHEN 用户启动实时导航 THEN 消防设施系统 SHALL 提供语音导航和实时位置跟踪
7. WHEN 用户查询最近设施 THEN 消防设施系统 SHALL 自动定位并高亮显示距离最近的3个可用设施
8. WHEN 用户在紧急模式下查询 THEN 消防设施系统 SHALL 优先显示状态正常且距离最近的设施

### 需求 11：系统性能与可靠性

**用户故事：** 作为系统用户，我希望系统响应快速且稳定可靠，以便在紧急情况下能够正常使用。

#### 验收标准

1. WHEN 用户执行常规查询操作 THEN 消防设施系统 SHALL 在2秒内返回结果
2. WHEN 系统处理并发请求 THEN 消防设施系统 SHALL 支持至少100个并发用户
3. WHEN 系统发生故障 THEN 消防设施系统 SHALL 在数据库中记录错误日志
4. WHEN 系统执行数据备份 THEN 消防设施系统 SHALL 每日执行全量备份并保留30天
5. WHEN 系统负载增加 THEN 消防设施系统 SHALL 支持水平扩展以提升处理能力
